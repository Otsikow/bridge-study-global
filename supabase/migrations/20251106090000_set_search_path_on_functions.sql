-- Ensure all security definer functions run with a safe search path
ALTER FUNCTION public.agent_can_view_student(uuid, uuid) SET search_path = public;
ALTER FUNCTION public.cleanup_agent_student_link() SET search_path = public;
ALTER FUNCTION public.cleanup_expired_typing_indicators() SET search_path = public;
ALTER FUNCTION public.create_notification(uuid, uuid, text, text, text, jsonb, text) SET search_path = public;
ALTER FUNCTION public.ensure_agent_student_link() SET search_path = public;
ALTER FUNCTION public.generate_tasks_for_application(uuid) SET search_path = public;
ALTER FUNCTION public.get_or_create_conversation(uuid, uuid, uuid) SET search_path = public;
ALTER FUNCTION public.get_primary_role(uuid) SET search_path = public;
ALTER FUNCTION public.get_program_filter_options(uuid) SET search_path = public;
ALTER FUNCTION public.get_public_featured_universities() SET search_path = public;
ALTER FUNCTION public.get_public_featured_universities(text) SET search_path = public;
ALTER FUNCTION public.get_unread_count(uuid, uuid) SET search_path = public;
ALTER FUNCTION public.get_unread_notification_count(uuid) SET search_path = public;
ALTER FUNCTION public.get_user_role(uuid) SET search_path = public;
ALTER FUNCTION public.get_user_tenant(uuid) SET search_path = public;
ALTER FUNCTION public.handle_new_user() SET search_path = public;
ALTER FUNCTION public.has_role(uuid, app_role) SET search_path = public;
ALTER FUNCTION public.is_admin_or_staff(uuid) SET search_path = public;
ALTER FUNCTION public.is_agent_for_application(uuid, uuid) SET search_path = public;
ALTER FUNCTION public.is_agent_for_student(uuid, uuid) SET search_path = public;
ALTER FUNCTION public.is_student_owner(uuid, uuid) SET search_path = public;
ALTER FUNCTION public.mark_all_notifications_read(uuid) SET search_path = public;
ALTER FUNCTION public.mark_notification_read(uuid) SET search_path = public;
ALTER FUNCTION public.notify_application_status_change() SET search_path = public;
ALTER FUNCTION public.notify_commission_change() SET search_path = public;
ALTER FUNCTION public.notify_course_recommendation(uuid, uuid, text) SET search_path = public;
ALTER FUNCTION public.notify_new_message() SET search_path = public;
ALTER FUNCTION public.on_application_stage_change() SET search_path = public;
ALTER FUNCTION public.prevent_direct_role_update() SET search_path = public;
ALTER FUNCTION public.search_programs(uuid, text, text[], text[], numeric, numeric, integer, integer, integer[], text, text, integer, integer) SET search_path = public;
ALTER FUNCTION public.set_application_student_profile_id() SET search_path = public;
ALTER FUNCTION public.sync_profile_role_from_user_roles() SET search_path = public;
ALTER FUNCTION public.sync_student_profile_id() SET search_path = public;
ALTER FUNCTION public.update_conversation_timestamp() SET search_path = public;
ALTER FUNCTION public.update_conversations_updated_at() SET search_path = public;
ALTER FUNCTION public.update_updated_at_column() SET search_path = public;
